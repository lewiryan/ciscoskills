<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Paessler on Cisco Skills</title>
    <link>https://ciscoskills.net/tags/paessler/</link>
    <description>Recent content in Paessler on Cisco Skills</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Wed, 03 Jun 2015 12:15:00 +0000</lastBuildDate><atom:link href="https://ciscoskills.net/tags/paessler/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>PRTG Daily Email Powershell Script</title>
      <link>https://ciscoskills.net/2015/06/03/prtg-daily-email-powershell-script/</link>
      <pubDate>Wed, 03 Jun 2015 12:15:00 +0000</pubDate>
      
      <guid>https://ciscoskills.net/2015/06/03/prtg-daily-email-powershell-script/</guid>
      <description>
        
          &lt;p&gt;So I don&#39;t write much powershell but recently I needed a way to send daily emails out of PRTG. Thanks Paessler which has kept it simple with their PRTG monitoring system as the hardest part of this script was getting the data in HTML, remember I don&#39;t write much powershell. ;) If you have not used PRTG before check it out if you need some alerting in your environment. Personally this is one of my favorite systems for just monitoring because a lot of other monitoring systems include everything but the kitchen sink and reality we just need to know what&#39;s up and what&#39;s down. This script grabs an XML file that PRTG builds and saves it as &amp;quot;table.xml&amp;quot; I have the script check if there are any sensors in trouble if not send an email. If PRTG is reporting a sensor or sensors that are in trouble this scripts builds an HTML document with a table andÂ list the sensors in trouble highlighting the status column with the appropriate color and sends an email.&lt;/p&gt;
&lt;!--adsense--&gt;
&lt;p&gt;Thanks goes to Martin Pugh who has provided the set-cellcolor function. :)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-ps1&#34; data-lang=&#34;ps1&#34;&gt;&lt;span class=&#34;ln&#34;&gt;  1&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# PRTG EMAIL ACTIVE ALARMS POWERSHELL SCRIPT.&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;  2&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# USE TASK SCHEDULER TO RUN THIS SCRIPT. &lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;  3&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Load up the function &amp;#34;Set-CellColor&amp;#34; thanks to Martin Pugh &amp;lt;img draggable=&amp;#34;false&amp;#34; role=&amp;#34;img&amp;#34; class=&amp;#34;emoji&amp;#34; alt=&amp;#34;ðŸ™‚&amp;#34; src=&amp;#34;https://s0.wp.com/wp-content/mu-plugins/wpcom-smileys/twemoji/2/svg/1f642.svg&amp;#34;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;  4&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Function&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Set-CellColor&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;  5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;cm&#34;&gt;&amp;lt;#
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt;  6&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.SYNOPSIS&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt;  7&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Function that allows you to set individual cell colors in an HTML table
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt;  8&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.DESCRIPTION&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt;  9&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        To be used inconjunction with ConvertTo-HTML this simple function allows you
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 10&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        to set particular colors for cells in an HTML table.  You provide the criteria
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 11&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        the script uses to make the determination if a cell should be a particular 
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 12&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        color (property -gt 5, property -like &amp;#34;*Apple*&amp;#34;, etc).
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 13&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 14&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        You can add the function to your scripts, dot source it to load into your current
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 15&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        PowerShell session or add it to your $Profile so it is always available.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 16&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 17&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        To dot source:
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 18&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;            .&amp;#34;.\Set-CellColor.ps1&amp;#34;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 19&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;             
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 20&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.PARAMETER&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; Property
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 21&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Property, or column that you will be keying on.  
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 22&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.PARAMETER&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; Color
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 23&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Name or 6-digit hex value of the color you want the cell to be
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 24&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.PARAMETER&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; InputObject
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 25&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        HTML you want the script to process.  This can be entered directly into the
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 26&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        parameter or piped to the function.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 27&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.PARAMETER&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; Filter
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 28&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Specifies a query to determine if a cell should have its color changed.  $true
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 29&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        results will make the color change while $false result will return nothing.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 30&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 31&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Syntax
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 32&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        &amp;lt;Property Name&amp;gt; &amp;lt;Operator&amp;gt; &amp;lt;Value&amp;gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 33&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 34&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        &amp;lt;Property Name&amp;gt;::= the same as $Property.  This must match exactly
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 35&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        &amp;lt;Operator&amp;gt;::= &amp;#34;-eq&amp;#34; | &amp;#34;-le&amp;#34; | &amp;#34;-ge&amp;#34; | &amp;#34;-ne&amp;#34; | &amp;#34;-lt&amp;#34; | &amp;#34;-gt&amp;#34;| &amp;#34;-approx&amp;#34; | &amp;#34;-like&amp;#34; | &amp;#34;-notlike&amp;#34; 
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 36&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;            &amp;lt;JoinOperator&amp;gt; ::= &amp;#34;-and&amp;#34; | &amp;#34;-or&amp;#34;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 37&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;            &amp;lt;NotOperator&amp;gt; ::= &amp;#34;-not&amp;#34;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 38&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 39&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        The script first attempts to convert the cell to a number, and if it fails it will
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 40&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        cast it as a string.  So 40 will be a number and you can use -lt, -gt, etc.  But 40%
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 41&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        would be cast as a string so you could only use -eq, -ne, -like, etc.  
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 42&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.PARAMETER&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; Row
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 43&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Instructs the script to change the entire row to the specified color instead of the individual cell.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 44&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.INPUTS&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 45&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        HTML with table
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 46&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.OUTPUTS&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 47&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        HTML
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 48&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.EXAMPLE&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 49&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        get-process | convertto-html | set-cellcolor -Propety cpu -Color red -Filter &amp;#34;cpu -gt 1000&amp;#34; | out-file c:\test\get-process.html
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 50&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; 
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 51&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Assuming Set-CellColor has been dot sourced, run Get-Process and convert to HTML.  
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 52&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Then change the CPU cell to red only if the CPU field is greater than 1000.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 53&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 54&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.EXAMPLE&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 55&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        get-process | convertto-html | set-cellcolor cpu red -filter &amp;#34;cpu -gt 1000 -and cpu -lt 2000&amp;#34; | out-file c:\test\get-process.html
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 56&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 57&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Same as Example 1, but now we will only turn a cell red if CPU is greater than 100 
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 58&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        but less than 2000.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 59&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 60&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.EXAMPLE&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 61&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        $HTML = $Data | sort server | ConvertTo-html -head $header | Set-CellColor cookedvalue red -Filter &amp;#34;cookedvalue -gt 1&amp;#34;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 62&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        PS C:\&amp;gt; $HTML = $HTML | Set-CellColor Server green -Filter &amp;#34;server -eq &amp;#39;dc2&amp;#39;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 63&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        PS C:\&amp;gt; $HTML | Set-CellColor Path Yellow -Filter &amp;#34;Path -like &amp;#34;&amp;#34;*memory*&amp;#34;&amp;#34;&amp;#34; | Out-File c:\Test\colortest.html
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 64&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 65&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Takes a collection of objects in $Data, sorts on the property Server and converts to HTML.  From there 
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 66&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        we set the &amp;#34;CookedValue&amp;#34; property to red if it&amp;#39;s greater then 1.  We then send the HTML through Set-CellColor
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 67&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        again, this time setting the Server cell to green if it&amp;#39;s &amp;#34;dc2&amp;#34;.  One more time through Set-CellColor
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 68&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        turns the Path cell to Yellow if it contains the word &amp;#34;memory&amp;#34; in it.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 69&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 70&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.EXAMPLE&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 71&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        $HTML = $Data | sort server | ConvertTo-html -head $header | Set-CellColor cookedvalue red -Filter &amp;#34;cookedvalue -gt 1&amp;#34; -Row
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 72&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 73&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Now, if the cookedvalue property is greater than 1 the function will highlight the entire row red.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 74&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;         
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 75&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.NOTES&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 76&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Author:             Martin Pugh
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 77&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Twitter:            @thesurlyadm1n
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 78&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Spiceworks:         Martin9700
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 79&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Blog:               www.thesurlyadmin.com
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 80&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;           
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 81&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        Changelog:
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 82&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;            1.5             Added ability to set row color with -Row switch instead of the individual cell
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 83&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;            1.03            Added error message in case the $Property field cannot be found in the table header
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 84&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;            1.02            Added some additional text to help.  Added some error trapping around $Filter
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 85&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;                            creation.
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 86&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;            1.01            Added verbose output
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 87&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;            1.0             Initial Release
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 88&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;.LINK&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 89&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;        http://community.spiceworks.com/scripts/show/2450-change-cell-color-in-html-table-with-powershell-set-cellcolor
&lt;/span&gt;&lt;span class=&#34;ln&#34;&gt; 90&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    #&amp;gt;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 91&lt;/span&gt; 
&lt;span class=&#34;ln&#34;&gt; 92&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CmdletBinding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()]&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 93&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;Param&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 94&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Mandatory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Position&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 95&lt;/span&gt;        &lt;span class=&#34;no&#34;&gt;[string]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Property&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 96&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Mandatory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Position&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 97&lt;/span&gt;        &lt;span class=&#34;no&#34;&gt;[string]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 98&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Mandatory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ValueFromPipeline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 99&lt;/span&gt;        &lt;span class=&#34;no&#34;&gt;[Object[]]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$InputObject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;100&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Mandatory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;101&lt;/span&gt;        &lt;span class=&#34;no&#34;&gt;[string]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;102&lt;/span&gt;        &lt;span class=&#34;no&#34;&gt;[switch]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Row&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;103&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;104&lt;/span&gt;     
&lt;span class=&#34;ln&#34;&gt;105&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;Begin&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;106&lt;/span&gt;        &lt;span class=&#34;nb&#34;&gt;Write-Verbose&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: Function Set-CellColor begins&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;107&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;108&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ToUpper&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IndexOf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Property&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ToUpper&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-ge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;109&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nv&#34;&gt;$Filter&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ToUpper&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Property&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ToUpper&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;`$&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;110&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;Try&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;111&lt;/span&gt;                    &lt;span class=&#34;no&#34;&gt;[scriptblock]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Filter&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;[scriptblock]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;112&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;113&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;Catch&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;114&lt;/span&gt;                    &lt;span class=&#34;nb&#34;&gt;Write-Warning&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: &amp;#34;&amp;#34;$Filter&amp;#34;&amp;#34; caused an error, stopping script!&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;115&lt;/span&gt;                    &lt;span class=&#34;nb&#34;&gt;Write-Warning&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;116&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;Exit&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;117&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;118&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;119&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;Else&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;120&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nb&#34;&gt;Write-Warning&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Could not locate $Property in the Filter, which is required.  Filter: $Filter&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;121&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;Exit&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;122&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;123&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;124&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;125&lt;/span&gt;     
&lt;span class=&#34;ln&#34;&gt;126&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;Process&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;127&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;ForEach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$InputObject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;128&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IndexOf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;tr&amp;gt;&amp;lt;th&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-ge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;129&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nb&#34;&gt;Write-Verbose&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: Processing headers...&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;130&lt;/span&gt;                &lt;span class=&#34;nv&#34;&gt;$Search&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Select-String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Pattern&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;th ?[a-z\-:;&amp;#34;=]*&amp;gt;(.*?)&amp;lt;\/th&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-AllMatches&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;131&lt;/span&gt;                &lt;span class=&#34;nv&#34;&gt;$Index&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;132&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;ForEach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Match&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;133&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Value&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Property&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;134&lt;/span&gt;                    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;k&#34;&gt;Break&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;135&lt;/span&gt;                    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;136&lt;/span&gt;                    &lt;span class=&#34;nv&#34;&gt;$Index&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;++&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;137&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;138&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Index&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;139&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nb&#34;&gt;Write-Warning&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: Unable to locate property: $Property in table header&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;140&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;Exit&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;141&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;142&lt;/span&gt;                &lt;span class=&#34;nb&#34;&gt;Write-Verbose&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: $Property column found at index: $Index&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;143&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;144&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-match&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;tr( style=&amp;#34;&amp;#34;background-color:.+?&amp;#34;&amp;#34;)?&amp;gt;&amp;lt;td&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;145&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nv&#34;&gt;$Search&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Select-String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Pattern&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;td ?[a-z\-:;&amp;#34;=]*&amp;gt;(.*?)&amp;lt;\/td&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-AllMatches&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;146&lt;/span&gt;                &lt;span class=&#34;nv&#34;&gt;$Value&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Value&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-as&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;[double]&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;147&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-not&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;148&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nv&#34;&gt;$Value&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Value&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;149&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;150&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Invoke-Command&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;151&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Row&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;152&lt;/span&gt;                    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nb&#34;&gt;Write-Verbose&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: Criteria met!  Changing row to $Color...&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;153&lt;/span&gt;                        &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-match&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;tr style=&amp;#34;&amp;#34;background-color:(.+?)&amp;#34;&amp;#34;&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;154&lt;/span&gt;                        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-replace&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;tr style=&amp;#34;&amp;#34;background-color:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;tr style=&amp;#34;&amp;#34;background-color:$Color&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;155&lt;/span&gt;                        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;156&lt;/span&gt;                        &lt;span class=&#34;k&#34;&gt;Else&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;157&lt;/span&gt;                        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;tr&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;tr style=&amp;#34;&amp;#34;background-color:$Color&amp;#34;&amp;#34;&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;158&lt;/span&gt;                        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;159&lt;/span&gt;                    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;160&lt;/span&gt;                    &lt;span class=&#34;k&#34;&gt;Else&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;161&lt;/span&gt;                    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;   &lt;span class=&#34;nb&#34;&gt;Write-Verbose&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: Criteria met!  Changing cell to $Color...&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;162&lt;/span&gt;                        &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;td style=&amp;#34;&amp;#34;background-color:$Color&amp;#34;&amp;#34;&amp;gt;$Value&amp;lt;/td&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;163&lt;/span&gt;                    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;164&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;165&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;166&lt;/span&gt;            &lt;span class=&#34;nb&#34;&gt;Write-Output&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$Line&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;167&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;168&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;169&lt;/span&gt;     
&lt;span class=&#34;ln&#34;&gt;170&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;End&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;171&lt;/span&gt;        &lt;span class=&#34;nb&#34;&gt;Write-Verbose&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: Function Set-CellColor completed&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;172&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;173&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;174&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Load up the variables, feel free to edit below like what is your email server?&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;175&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$smtp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;mailserver.example.com&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;176&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Who is this email going to?&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;177&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$to&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Mr. Joe &amp;lt;joe@example.com&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;178&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Carbon Copy anyone?&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;179&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$cc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Mr. Admin &amp;lt;admin@example.com&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;180&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$from&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;PRTG Network Monitor &amp;lt;PRTG@example.com&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;181&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$subject&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;PRTG Checks&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;182&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$time&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-Date&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;183&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Get a table ready in HTML just in case we have alerts in PRTG.&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;184&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;style&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;185&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;BODY{background-color:White;}&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;186&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;TABLE{border-width: 1px;border-style: solid;border-color: black;border-collapse: collapse;}&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;187&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;TH{Font-family: Courier; color: white; border-width: 1px;padding: 3px;border-style: solid;border-color: black;background-color:black}&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;188&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;TD{Font-family: Courier; border-width: 1px;padding: 3px;border-style: solid;border-color:}&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;189&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;/style&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;190&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Write out something in HTML in case we have alerts in PRTG.&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;191&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;H2&amp;gt;PRTG Alerts&amp;lt;/H2&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;p&amp;gt;Houston, we have a problem so please reference the chart below.&amp;lt;/p&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;193&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;p&amp;gt;System Generated at $time.&amp;lt;/p&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;194&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Write out something in HTML in case no alerts are active. &lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;H2&amp;gt;PRTG Alerts &amp;lt;/H2&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;196&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;p&amp;gt;No alerts being reported.&amp;lt;/p&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;197&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;p&amp;gt;System Generated at $time.&amp;lt;/p&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;198&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# URL to your PRTG server you will need to reference a local user account and password that has access to PRTG. See the end of the URL. &lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;199&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$url&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://prtg.example.com/api/table.xml?content=sensors&amp;amp;columns=objid,downtimesince,device,sensor,lastvalue,status,message,priority&amp;amp;filter_status=5&amp;amp;filter_status=4&amp;amp;filter_status=10&amp;amp;filter_status=13&amp;amp;filter_status=14&amp;amp;sortby=priority&amp;amp;username=GOES_HERE&amp;amp;passhash=GOES_HERE&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Where do you want to store the XML file?&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;201&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$destination&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\PRTG-DAILY-EMAIL\table.xml&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;202&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# What colors do you like for each alert?&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;203&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# You have a lot to choose from https://msdn.microsoft.com/en-us/library/aa358802.aspx&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;204&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$AckColor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;LightPink&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;205&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$AckMsg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Down (Acknowledged) &amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;206&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DownColor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Red&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;207&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DownMsg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Down &amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;208&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$WarnColor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Yellow&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;209&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$WarnMsg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Warning &amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;210&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$SimColor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;DarkSalmon&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;211&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$SimMsg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Down  (simulated error)&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;212&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$outfile&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\PRTG-DAILY-EMAIL\HTML.htm&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;213&lt;/span&gt; 
&lt;span class=&#34;ln&#34;&gt;214&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Let&amp;#39;s run the powershell script&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;215&lt;/span&gt; 
&lt;span class=&#34;ln&#34;&gt;216&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$url&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Outfile&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$destination&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;217&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$xml&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;[xml]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Get-Content&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;.\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;218&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# If nothing is alerting in PRTG we don&amp;#39;t need to stay around. Let&amp;#39;s say something about it and quit out.&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;219&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$xml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sensors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;totalcount&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;220&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ConvertTo-Html&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Body&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Out-File&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$outfile&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;221&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$emailbody&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-Content&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$outfile&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Out-String&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;222&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;send-MailMessage&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-BodyAsHtml&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-SmtpServer&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$smtp&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-To&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$to&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Cc&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cc&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-From&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$from&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Subject&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$subject&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-body&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$emailbody&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;223&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;224&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;225&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$xml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sensors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Sort-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Property&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;select &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;downtimesince&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;message_raw&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;226&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ConvertTo-HTML&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-head&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-body&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;227&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Set-cellcolor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;status&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$WarnColor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Filter&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;status -eq &amp;#39;$WarnMsg&amp;#39;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;228&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Set-cellcolor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;status&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$DownColor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Filter&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;status -eq&amp;#39;$DownMsg&amp;#39;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;229&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Set-cellcolor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;status&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$AckColor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Filter&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;status -eq&amp;#39;$AckMsg&amp;#39;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;230&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Set-cellcolor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;status&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$SimColor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Filter&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;status -eq&amp;#39;$SimMsg&amp;#39;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;231&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HTML&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Out-File&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$outfile&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;232&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$emailbody&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-Content&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$outfile&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Out-String&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;233&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;send-MailMessage&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-BodyAsHtml&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-SmtpServer&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$smtp&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-To&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$to&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Cc&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cc&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-From&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$from&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Subject&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$subject&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-body&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$emailbody&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;234&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So in the end you should get an email that looks something below if something is wrong. That&#39;s all I got I hope this information is helpful feel free to edit this and use it! &lt;img src=&#34;https://ciscoskills.net/images/2015/06/prtg-sample-alert1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.paessler.com/&#34;&gt;https://www.paessler.com/&lt;/a&gt;&lt;/p&gt;

        
      </description>
    </item>
    
  </channel>
</rss>
