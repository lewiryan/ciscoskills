<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Syslog on Cisco Skills</title>
    <link>https://ciscoskills.net/tags/syslog/</link>
    <description>Recent content in Syslog on Cisco Skills</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Tue, 05 Feb 2019 17:15:07 +0000</lastBuildDate><atom:link href="https://ciscoskills.net/tags/syslog/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>FMC Syslog with Graylog Extractor</title>
      <link>https://ciscoskills.net/2019/02/fmc-syslog-with-graylog-extractor/</link>
      <pubDate>Tue, 05 Feb 2019 17:15:07 +0000</pubDate>
      
      <guid>https://ciscoskills.net/2019/02/fmc-syslog-with-graylog-extractor/</guid>
      <description>
        
          &lt;p&gt;Let&#39;s continue to talk about the Cisco Firepower Management Center, in this post we are going to look at sending connection events over to syslog. In this example I&#39;m using &lt;a href=&#34;https://www.graylog.org/&#34;&gt;Graylog&lt;/a&gt; which is an open source logging platform and  although any syslog server would work, one of the problems with syslogs is there is little uniformity when you have different systems sending these logs. One of the things that Graylog can to do is extract the raw message and put each part of message into a separate searchable field. We&#39;ll configure the FMC to send syslogs and then configure an extractor on Graylog.&lt;/p&gt;
&lt;p&gt;So we have the FMC and Graylog in our environment setup. We&#39;ll want to first configure the FMC and add a syslog server. We can do this two ways, one way is we can go to into Policy tab-&amp;gt; Actions-&amp;gt;Alerts-&amp;gt;Create Alert (Down Arrow)-&amp;gt;Create Syslog Alert.
&lt;img src=&#34;https://ciscoskills.net/images/2018/08/fmc-syslog-1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;You could also go into an access control policy and select log (&lt;img src=&#34;https://ciscoskills.net/images/2018/08/fmc-log-symbol.jpg&#34; alt=&#34;::inline&#34;&gt;) icon either in the default action or on a rule you would like to log. Another window will show and select the green plus icon and add the syslog server that way.
&lt;img src=&#34;https://ciscoskills.net/images/2018/08/fmc-syslog-2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;Once that is out-of-the-way we can now go into Graylog and configure an extractor on the syslog input. This is located under System-&amp;gt;Inputs then under the syslog input select manage extractor. On the actions tab select import extractor and paste this JSON followed by selecting the Add extractors to input at the bottom of the page.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;ln&#34;&gt; 1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 2&lt;/span&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;extractors&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 3&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 4&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;FMC – Default Fields&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 5&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;extractor_type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;grok&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 6&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;converters&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 7&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;order&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 8&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;cursor_strategy&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;copy&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt; 9&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;source_field&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;10&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;target_field&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;11&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;extractor_config&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;12&lt;/span&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;grok_pattern&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;%{WORD:field}: Protocol: %{WORD:protocol}, SrcIP: %{IP:Source_IP}, OriginalClientIP: ::, DstIP: %{IP:Destination_IP}, SrcPort: %{INT:src_port}, DstPort: %{INT:dest_port}, TCPFlags: %{WORD:flags}, IngressZone: %{HOSTNAME:ingress_zone}, EgressZone: %{HOSTNAME:egress_zone}, DE: %{DATA:detect_engine}, Policy: %{DATA:policy}, ConnectType: %{WORD:connectType}, AccessControlRuleName: %{DATA:ACLRuleName}, AccessControlRuleAction: %{DATA:ACLRuleAction},&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;13&lt;/span&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;named_captures_only&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;14&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;15&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;condition_type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;regex&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;16&lt;/span&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;condition_value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;( SFIMS:)&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;17&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;18&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;2.4.6&amp;#34;&lt;/span&gt;
&lt;span class=&#34;ln&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I have noticed that it might take some time for Graylog to extract the messages as well as it seems there is a delay in the Cisco FMC when sending syslogs but If everything is configured correctly you should start to see logs coming into Graylog. I normally use this for researching firewall rules as its easier to run a search in Graylog then it is on the FMC. Here is what the raw message looks like:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;ln&#34;&gt;1&lt;/span&gt;_DMZ-FW02 SFIMS: Protocol: TCP, SrcIP: 172.25.45.55, OriginalClientIP: ::, DstIP: 172.25.30.82, SrcPort: 58996, DstPort: 1433, TCPFlags: 0x0, IngressZone: LOC-DMZ, EgressZone: LOC-INSIDE, DE: Primary Detection Engine (d4d9f400-c6d2-4065-9f90-da61a963b980), Policy: Acme DMZ ACP, ConnectType: Start, AccessControlRuleName: WEBSRVS-&amp;gt;SQLSRVS-&amp;gt;TCP1443, AccessControlRuleAction: Allow, Prefilter Policy: Default Prefilter Policy, UserName: No Authentication Required, InitiatorPackets: 2, ResponderPackets: 1, InitiatorBytes: 120, ResponderBytes: 66, NAPPolicy: Acme DMZ NAP, DNSResponseType: No Error, Sinkhole: Unknown, URLCategory: Unknown, URLReputation: Risk unknown_
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is what Graylog would be able to extract from that message with our extractor:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;ln&#34;&gt; 1&lt;/span&gt;ACLRuleAction
&lt;span class=&#34;ln&#34;&gt; 2&lt;/span&gt;Allow
&lt;span class=&#34;ln&#34;&gt; 3&lt;/span&gt;ACLRuleName
&lt;span class=&#34;ln&#34;&gt; 4&lt;/span&gt;WEBSRVS-&amp;gt;SQLSRVS-&amp;gt;TCP1443
&lt;span class=&#34;ln&#34;&gt; 5&lt;/span&gt;Destination_IP
&lt;span class=&#34;ln&#34;&gt; 6&lt;/span&gt;172.25.30.82
&lt;span class=&#34;ln&#34;&gt; 7&lt;/span&gt;Source_IP
&lt;span class=&#34;ln&#34;&gt; 8&lt;/span&gt;172.25.45.55
&lt;span class=&#34;ln&#34;&gt; 9&lt;/span&gt;connectType
&lt;span class=&#34;ln&#34;&gt;10&lt;/span&gt;Start
&lt;span class=&#34;ln&#34;&gt;11&lt;/span&gt;dest_port
&lt;span class=&#34;ln&#34;&gt;12&lt;/span&gt;1433
&lt;span class=&#34;ln&#34;&gt;13&lt;/span&gt;detect_engine
&lt;span class=&#34;ln&#34;&gt;14&lt;/span&gt;Primary Detection Engine (d4d9f400-c6d2-4065-9f90-da61a963b980)
&lt;span class=&#34;ln&#34;&gt;15&lt;/span&gt;egress_zone
&lt;span class=&#34;ln&#34;&gt;16&lt;/span&gt;LOC-INSIDE
&lt;span class=&#34;ln&#34;&gt;17&lt;/span&gt;field
&lt;span class=&#34;ln&#34;&gt;18&lt;/span&gt;SFIMS
&lt;span class=&#34;ln&#34;&gt;19&lt;/span&gt;flags
&lt;span class=&#34;ln&#34;&gt;20&lt;/span&gt;0x0
&lt;span class=&#34;ln&#34;&gt;21&lt;/span&gt;ingress_zone
&lt;span class=&#34;ln&#34;&gt;22&lt;/span&gt;LOC-DMZ
&lt;span class=&#34;ln&#34;&gt;23&lt;/span&gt;policy
&lt;span class=&#34;ln&#34;&gt;24&lt;/span&gt;Acme DMZ ACP
&lt;span class=&#34;ln&#34;&gt;25&lt;/span&gt;protocol
&lt;span class=&#34;ln&#34;&gt;26&lt;/span&gt;TCP
&lt;span class=&#34;ln&#34;&gt;27&lt;/span&gt;src_port
&lt;span class=&#34;ln&#34;&gt;28&lt;/span&gt;58996
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;With this grok pattern that we created with Graylog we are able to search these fields like Source IP and Destination IP and even the ACLRule name.
&lt;img src=&#34;https://ciscoskills.net/images/2018/08/gl-aclrulename.png&#34; alt=&#34;gl-aclrulename&#34;&gt;&lt;/p&gt;
&lt;p&gt;This makes it much easier to search these results as well as put this type of data into dashboards or reports. Like always I hope this information is helpful you can find more information about Graylog by hitting their site and try it out for yourself. :)&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Install RSYSLOG &amp; LogAnalyzer on CentOS 6.5</title>
      <link>https://ciscoskills.net/2014/06/install-rsyslog-loganalyzer-on-centos-6.5/</link>
      <pubDate>Wed, 11 Jun 2014 12:00:54 +0000</pubDate>
      
      <guid>https://ciscoskills.net/2014/06/install-rsyslog-loganalyzer-on-centos-6.5/</guid>
      <description>
        
          &lt;h2 id=&#34;rsyslog-loganalyzerhttpsystemstechblogfileswordpresscom201406rsyslog-loganalyzerpngw300httpssystemstechblogfileswordpresscom201406rsyslog-loganalyzerpngi-am-looking-at-rsyslog-which-is-fast-syslog-system-and-loganalyzer-as-an-upfront-web-gui-for-those-logs-the-loganalyzer-application-offers-searching-of-various-syslogs-all-of-which-is-open-source-and-available-to-download-in-this-guide-i-will-go-through-the-steps-to-get-these-two-applications-to-work-together-and-in-the-end-of-this-tutorial-we-should-have-a-working-syslog-system-ready-to-take-logs-the-operating-system-i-am-using-is-the-latest-centos-65-minimal-lets-get-started-using-vmware-workstation-the-first-thing-i-have-done-is-installed-a-minimal-version-of-centos-on-the-vm-the-vm-has-30gb-on-the-disk-with-one-processor-and-two-cores-with-2gb-of-ram-which-took-about-10-minutes-to-install-once-the-vm-rebooted-i-login-into-the-root-account-and-ran-the-command-yum-update-and-accepted-all-the-updates-the-operating-system-was-able-to-find-which-took-about-10-minutes-lets-first-added-some-housekeeping-packages-like-wget-and-nano-yum-install-wget-nano-the-minimal-install-does-not-include-wget-or-nano-nano-is-a-good-text-editor-for-people-who-dont-want-to-use-vi--i-have-also-disabled-iptables-service-iptables-stop--chkconfig-iptables-off--in-this-demo-but-this-is-not-recommend-in-a-production-environment-first-lets-install-apache-codeyum-install-httpdcode-start-the-service-codeservice-httpd-startcode-lets-make-sure-the-service-automatically-when-the-server-reboots-codechkconfig-httpd-oncode-lets-test-to-make-sure-you-can-get-to-the-sample-webpage-httpyour-server-ip-addresshttpyour-server-ip-address-if-it-is-working-should-look-something-like-this-apche2httpsystemstechblogfileswordpresscom201406rsyslog-1pngw300httpssystemstechblogfileswordpresscom201406rsyslog-1png-second-install-mysql-codeyum-install-mysql-mysql-servercode-after-install-is-finished-start-it-up-codeservice-mysqld-startcode-like-apache-lets-make-sure-this-service-starts-when-the-server-reboots-codechkconfig-mysqld-oncode-for-security-change-the-mysql-admin-password-codemysqladmin--u-root-password-yournewpasswordcode-lets-test-mysql-by-logging-into-the-database-codemysql--u-root--pcode-did-you-get-something-like-below-codewelcome-to-the-mysql-monitor-commands-end-with--or-g-your-mysql-connection-id-is-4-server-version-5173-source-distribution-copyright-c-2000-2013-oracle-andor-its-affiliates-all-rights-reserved-oracle-is-a-registered-trademark-of-oracle-corporation-andor-its-affiliates-other-names-may-be-trademarks-of-their-respective-owners-type-help-or-h-for-help-type-c-to-clear-the-current-input-statement-mysqlcode-thrid-install-php-codeyum-install-php-php-mysql-php-gdcode-once-finished-installing-create-a-phpinfo-page-codenano-varwwwhtmltestphpcode-type-the-following-and-save-the-testphp-codephp-phpinfo-code-restart-the-apache-service-codeservice-httpd-restartcode-open-up-your-browser-and-type-httpyour-server-ip-addresstestphp-you-should-get-something-like-below-php533httpsystemstechblogfileswordpresscom201406rsyslog-2pngw300httpssystemstechblogfileswordpresscom201406rsyslog-2png-fourth-install-rsyslog-a-couple-things-first-centos-uses-an-older-version-of-rsyslog-so-why-not-use-the-latest-stable-version-of-rsyslog-codewget-httprpmsadisconcomv8-stablersyslogrepo-mv-rsyslogrepo-etcyumreposdrsyslogrepo-yum-install-rsyslog---skip-brokencode-when-the-server-reboots-lets-start-this-service-automatically-codechkconfig-rsyslog-oncode-rsyslog-has-a-createdb-script-in-the-following-location-usrsharedocrsyslog-mysql-821createdbsql-you-can-leave-this-alone-or-you-can-optionally-change-the-database-name-dont-be-boring-in-this-example-i-changed-it-to-rsyslogdb--still-a-little-boring-codenano-usrsharedocrsyslog-mysql-821createdbsql-create-database-rsyslogdb-use-rsyslogdb-create-table-systemevents-code-lets-create-the-rsyslogdb-database-codemysql--u-root--p--usrsharedocrsyslog-mysql-821createdbsqlcode-should-be-able-to-access-the-database-codemysql--u-root--p-rsyslogdbcode-for-security-add-a-dedicated-administrator-called-rsyslogdbadm-for-only-this-database-with-a-password-of-what-you-want-codegrant-all-on-rsyslogdb-to-rsyslogdbadminlocalhost-identified-by-newpasswordhere-flush-privileges-exitcode-did-it-all-work-lets-test-logging-in-and-exit-mysql-codemysql--u-rsyslogdbadmin--p-rsyslogdbcode-uncomment-the-following-modules-in-the-rsyslogconf-located-in-etcrsyslogconf-file-and-add-the-mysql-module-line-code-provides-udp-syslog-reception--for-parameters-see-httpwwwrsyslogcomdocimudphtml-moduleloadimudp--needs-to-be-done-just-once-inputtypeimudp-port514--provides-tcp-syslog-reception--for-parameters-see-httpwwwrsyslogcomdocimtcphtml-moduleloadimtcp--needs-to-be-done-just-once-inputtypeimtcp-port514--load-the-mysql-module-moduleloadommysqlcode-you-may-also-want-to-edit-the-rules-section-to-disable-logging-to-the-console-in-this-example-i-said-log-only-syslogs-that-have-a-level-of-emergency-to-the-console-code-rules---log-all-kernel-messages-to-the-console--logging-much-else-clutters-up-the-screen-emerg-devconsolecode-also-note-that-rsyslog-logs-everything-it-sees-to-a-log-folder-by-default-as-well-if-you-are-using-loganalyzer-to-view-logs-like-in-our-example-we-are-storing-those-logs-in-a-mysql-database-as-well-depending-on-how-much-logging-you-have-you-may-either-want-to-disable-this-and-have-loganalyzer-do-it-all-or-setup-a-cron-job-to-drop-these-once-in-a-while-code-log-anything-except-mail-of-level-info-or-higher--dont-log-private-authentication-messages-infomailnoneauthprivnonecronnone-varlogmessages--the-authpriv-file-has-restricted-access-authpriv-varlogsecure--log-all-the-mail-messages-in-one-place-mail--varlogmaillog--log-cron-stuff-cron-varlogcron--everybody-gets-emergency-messages-emerg---save-news-errors-of-level-crit-and-higher-in-a-special-file-uucpnewscrit-varlogspooler--save-boot-messages-also-to-bootlog-local7-varlogbootlogcode-in-the-forwarding-rule-add-the-following-this-tells-rsyslog-to-send-all-syslogs-to-the-mysql-database-code--begin-forwarding-rule---lets-forward-all-logs-to-the-mysql-database--ommysql127001rsyslogdbrsyslogdbadminyourpassword-code-save-and-exit-the-configuration-file-and-restart-the-rsyslog-service-to-load-the-new-configuration-codeservice-rsyslog-restartcode-you-should-now-have-some-logs-in-mysql-database-check-it-by-using-the-following-codemysql--u-rsyslogdbadmin--p-rsyslogdb-mysql-select-count-from-systemevents-------------count--------------2-------------code-fifth-download-the-loganalyzer-web-application-codewget-httpdownloadadisconcomloganalyzerloganalyzer-365targzcode-unpack-the-tarball-codetar-zxvf-loganalyzer-365targzcode-copy-the-install-files-into-apache-codecp--r-loganalyzer-365src-varwwwhtmlloganalyzer-cp--r-loganalyzer-365contrib-varwwwhtmlloganalyzercode-lets-go-into-those-folders-codecd-varwwwhtmlloganalyzercode-add-some-execution-permission-to-these-files-codechmod-x-configuresh-secureshcode-run-the-configuresh-which-will-create-a-blank-configphp-file-as-well-as-set-write-access-coderootlocalhost--configureshcode-to-complete-the-install-of-loganalyzer-we-have-to-following-the-prompts-on-the-web-browse-to-httpyour-server-ip-addressloganalyzer-you-should-get-an-error-page-like-below-select-the-here-link-to-start-the-install-loganalyzer-1httpsystemstechblogfileswordpresscom201406rsyslog-3pngw300httpssystemstechblogfileswordpresscom201406rsyslog-3pngloganalyzer-will-do-a-couple-of-tests-to-verify-configuration-click-next-to-start-them-loganalyzer-2httpsystemstechblogfileswordpresscom201406rsyslog-4pngw300httpssystemstechblogfileswordpresscom201406rsyslog-4png-select-next-if-the-configphp-file-can-be-written-loganalyzer-3httpsystemstechblogfileswordpresscom201406rsyslog-5pngw300httpssystemstechblogfileswordpresscom201406rsyslog-5png-in-the-basic-configuration-use-the-following-image-below-to-reference-your-installation-loganalyzer-4httpsystemstechblogfileswordpresscom201406rsyslog-6pngw300httpssystemstechblogfileswordpresscom201406rsyslog-6png-the-next-page-is-to-create-tables-in-the-mysql-database-go-ahead-and-select-next-loganalyzer-5httpsystemstechblogfileswordpresscom201406rsyslog-7pngw300httpssystemstechblogfileswordpresscom201406rsyslog-7png-the-next-page-displays-any-errors-if-any-sql-results-failed-select-next-if-you-dont-have-any-failed-statements-loganalyzer-6httpsystemstechblogfileswordpresscom201406rsyslog-8pngw300httpssystemstechblogfileswordpresscom201406rsyslog-8png-in-step-6-we-create-a-main-user-account-to-log-into-the-loganalyzer-web-app-loganalyzer-7httpsystemstechblogfileswordpresscom201406rsyslog-9pngw300httpssystemstechblogfileswordpresscom201406rsyslog-9png-in-step-7-we-create-our-source-for-syslog-messages-follow-the-image-below-for-a-reference-loganalyzer-8httpsystemstechblogfileswordpresscom201406rsyslog-10pngw300httpssystemstechblogfileswordpresscom201406rsyslog-10png-looks-like-we-are-done-the-select-the-here-link-to-go-to-the-login-page-loganalyzer-9httpsystemstechblogfileswordpresscom201406rsyslog-11pngw300httpssystemstechblogfileswordpresscom201406rsyslog-11png-loganalyzer-10httpsystemstechblogfileswordpresscom201406rsyslog-12pngw300httpssystemstechblogfileswordpresscom201406rsyslog-12png-done-some-last-things-to-check-with-loganalyzer-is-it-does-dns-lookups-of-ip-address-which-can-slow-down-the-website-if-you-have-a-lot-of-ips-in-your-logs-to-disable-that-feature-go-to-admin-center--uncheck-resolve-ip-addresses-using-dns-i-have-personally-pushed-up-to-500-syslog-messages-every-10-seconds-thanks-to-the-kiwi-syslog-generator-and-did-not-see-any-performance-hits-other-than-the-dns-issue-hope-this-information-is-helpful-let-me-know-if-you-have-used-loganalyzer-in-a-production-environment-are-there-any-gotchas-i-have-just-been-testing-it-on-my-lab-and-so-far-so-good-links-centoshttpwwwcentosorg-mysqlhttpwwwmysqlcom-rsysloghttpwwwrsyslogcom-loganalyzerhttploganalyzeradisconcom&#34;&gt;&lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-loganalyzer.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-loganalyzer.png?w=300&#34; alt=&#34;rsyslog-loganalyzer&#34;&gt;&lt;/a&gt;I am looking at rsyslog which is fast syslog system and Loganalyzer as an upfront web GUI for those logs. The Loganalyzer application offers searching of various syslogs, all of which is open source and available to download. In this guide I will go through the steps to get these two applications to work together and in the end of this tutorial we should have a working syslog system ready to take logs! The operating system I am using is the latest CentOS 6.5 minimal. Let&#39;s get started. Using VMware Workstation the first thing I have done is installed a minimal version of CentOS on the VM. The VM has 30GB on the disk with one processor and two cores with 2GB of RAM. (Which took about 10 minutes to install) Once the VM rebooted I login into the root account and ran the command &lt;strong&gt;yum update&lt;/strong&gt; and accepted all the updates the operating system was able to find (Which took about 10 minutes) Let’s first added some housekeeping packages like wget and nano &lt;strong&gt;yum install wget nano&lt;/strong&gt; .The minimal install does not include wget, or nano. Nano is a good text editor for people who don’t want to use VI :) I have also disabled iptables (&lt;strong&gt;service iptables stop&lt;/strong&gt; &amp;amp; &lt;strong&gt;chkconfig iptables off&lt;/strong&gt; ) in this demo but this is not recommend in a production environment. &lt;strong&gt;FIRST&lt;/strong&gt;: Let’s install apache: [code]yum install httpd[/code] Start the Service: [code]service httpd start[/code] Let’s make sure the service automatically when the server reboots: [code]chkconfig httpd on[/code] Let’s test to make sure you can get to the sample webpage, &lt;a href=&#34;http://your-server-ip-address&#34;&gt;http://your-server-ip-address&lt;/a&gt; if it is working should look something like this. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-1.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-1.png?w=300&#34; alt=&#34;apche2&#34;&gt;&lt;/a&gt; &lt;strong&gt;SECOND&lt;/strong&gt;: Install MySQL [code]yum install mysql mysql-server[/code] After install is finished start it up: [code]service mysqld start[/code] Like apache, let’s make sure this service starts when the server reboots: [code]chkconfig mysqld on[/code] For security change the MySQL Admin password: [code]mysqladmin -u root password &#39;YourNewPassword&#39;[/code] Let’s Test MySQL, by logging into the database: [code]mysql -u root -p[/code] Did you get something like below? [code]Welcome to the MySQL monitor. Commands end with ; or \g. Your MySQL connection id is 4 Server version: 5.1.73 Source distribution Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement. mysql&amp;gt;[/code] &lt;strong&gt;THRID&lt;/strong&gt;: Install PHP, [code]yum install php php-mysql php-gd[/code] Once finished installing create a phpinfo page. [code]nano /var/www/html/test.php[/code] Type the following and save the test.php [code]&lt;?php phpinfo(); ?&gt;[/code] Restart the Apache Service [code]service httpd restart[/code] Open up your browser and type http://your-server-ip-address/test.php You should get something like below. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-2.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-2.png?w=300&#34; alt=&#34;php533&#34;&gt;&lt;/a&gt; &lt;strong&gt;FOURTH&lt;/strong&gt;: Install Rsyslog, A couple things first, CentOS uses an older version of rsyslog, so why not use the latest stable version of rsyslog. [code]wget &lt;a href=&#34;http://rpms.adiscon.com/v8-stable/rsyslog.repo&#34;&gt;http://rpms.adiscon.com/v8-stable/rsyslog.repo&lt;/a&gt; mv rsyslog.repo /etc/yum.repos.d/rsyslog.repo yum install rsyslog* --skip-broken[/code] When the server reboots let’s start this service automatically. [code]chkconfig rsyslog on[/code] Rsyslog has a createDB script in the following location: &lt;strong&gt;/usr/share/doc/rsyslog-mysql-8.2.1/createDB.sql&lt;/strong&gt;, you can leave this alone or you can optionally change the database name. (Don’t be boring) In this example I changed it to rsyslogdb (… still a little boring) [code]nano /usr/share/doc/rsyslog-mysql-8.2.1/createDB.sql CREATE DATABASE rsyslogdb; USE rsyslogdb; CREATE TABLE SystemEvents [...][/code] Let’s create the rsyslogdb database: [code]mysql -u root -p &amp;lt; /usr/share/doc/rsyslog-mysql-8.2.1/createDB.sql[/code] Should be able to access the database: [code]mysql -u root -p rsyslogdb[/code] For security add a dedicated administrator called rsyslogdbadm for only this database with a password of what you want. [code]GRANT ALL ON rsyslogdb.* TO rsyslogdbadmin@localhost IDENTIFIED BY &#39;NewPasswordHere&#39;; FLUSH PRIVILEGES; exit[/code] Did it all work? Let’s test logging in and exit mysql. [code]mysql -u rsyslogdbadmin -p rsyslogdb[/code] Uncomment the following modules in the rsyslog.conf (Located in &lt;strong&gt;/etc/rsyslog.conf&lt;/strong&gt;) file and add the MySQL module line. [code]# Provides UDP syslog reception # for parameters see &lt;a href=&#34;http://www.rsyslog.com/doc/imudp.html&#34;&gt;http://www.rsyslog.com/doc/imudp.html&lt;/a&gt; module(load=&amp;quot;imudp&amp;quot;) # needs to be done just once input(type=&amp;quot;imudp&amp;quot; port=&amp;quot;514&amp;quot;) # Provides TCP syslog reception # for parameters see &lt;a href=&#34;http://www.rsyslog.com/doc/imtcp.html&#34;&gt;http://www.rsyslog.com/doc/imtcp.html&lt;/a&gt; module(load=&amp;quot;imtcp&amp;quot;) # needs to be done just once input(type=&amp;quot;imtcp&amp;quot; port=&amp;quot;514&amp;quot;) # Load the MySQL Module module(load=&amp;quot;ommysql&amp;quot;)[/code] You may also want to edit the Rules section to disable logging to the console, in this example I said log only syslogs that have a level of emergency to the console. [code]#### RULES #### # Log all kernel messages to the console. # Logging much else clutters up the screen. *.emerg* /dev/console[/code] Also note that rsyslog logs everything it sees to a log folder by default as well. If you are using LogAnalyzer to view logs like in our example we are storing those logs in a MySQL database as well. Depending on how much logging you have you may either want to disable this and have LogAnalyzer do it all or setup a cron job to drop these once in a while. [code]# Log anything (except mail) of level info or higher. # Don&#39;t log private authentication messages! *.info;mail.none;authpriv.none;cron.none /var/log/messages # The authpriv file has restricted access. authpriv.* /var/log/secure # Log all the mail messages in one place. mail.* -/var/log/maillog # Log cron stuff cron.* /var/log/cron # Everybody gets emergency messages *.emerg * # Save news errors of level crit and higher in a special file. uucp,news.crit /var/log/spooler # Save boot messages also to boot.log local7.* /var/log/boot.log[/code] In the forwarding rule add the following, this tells rsyslog to send all syslogs to the MySQL database. [code]# ### begin forwarding rule ### # Let&#39;s forward all logs to the MySQL Database *.* :ommysql:127.0.0.1,rsyslogdb,rsyslogdbadmin,YourPassword …[/code] Save and exit the configuration file and restart the Rsyslog service to load the new configuration. [code]service rsyslog restart[/code] You should now have some logs in MySQL Database, check it by using the following: [code]mysql -u rsyslogdbadmin -p rsyslogdb mysql&amp;gt; select count(*) from SystemEvents; +----------+ | count(*) | +----------+ |        2 | +----------+ [/code] &lt;strong&gt;FIFTH&lt;/strong&gt;: Download the LogAnalyzer web application, [code]wget &lt;a href=&#34;http://download.adiscon.com/loganalyzer/loganalyzer-3.6.5.tar.gz&#34;&gt;http://download.adiscon.com/loganalyzer/loganalyzer-3.6.5.tar.gz&lt;/a&gt;[/code] Unpack the tarball: [code]tar zxvf loganalyzer-3.6.5.tar.gz[/code] Copy the install files into Apache. [code]cp -r loganalyzer-3.6.5/src/ /var/www/html/loganalyzer cp -r loganalyzer-3.6.5/contrib/* /var/www/html/loganalyzer/[/code] Let’s go into those folders: [code]cd /var/www/html/loganalyzer/[/code] Add some execution permission to these files: [code]chmod +x configure.sh secure.sh[/code] Run the ./configure.sh, which will create a blank config.php file as well as set write access. [code][root@localhost ]# ./configure.sh[/code] To complete the install of LogAnalyzer we have to following the prompts on the web. Browse to http://your-server-ip-address/loganalyzer You should get an error page like below. Select the here link to start the install. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-3.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-3.png?w=300&#34; alt=&#34;loganalyzer-1&#34;&gt;&lt;/a&gt;Loganalyzer will do a couple of tests to verify configuration click next to start them. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-4.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-4.png?w=300&#34; alt=&#34;loganalyzer-2&#34;&gt;&lt;/a&gt; Select Next if the config.php file can be written. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-5.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-5.png?w=300&#34; alt=&#34;loganalyzer-3&#34;&gt;&lt;/a&gt; In the Basic Configuration use the following image below to reference your installation. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-6.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-6.png?w=300&#34; alt=&#34;loganalyzer-4&#34;&gt;&lt;/a&gt; The next page is to create tables in the MySQL database go ahead and select next. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-7.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-7.png?w=300&#34; alt=&#34;loganalyzer-5&#34;&gt;&lt;/a&gt; The next page displays any errors if any SQL Results failed, select next if you don&#39;t have any failed statements. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-8.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-8.png?w=300&#34; alt=&#34;loganalyzer-6&#34;&gt;&lt;/a&gt; In step 6 we create a main user account to log into the LogAnalyzer web app. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-9.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-9.png?w=300&#34; alt=&#34;loganalyzer-7&#34;&gt;&lt;/a&gt; In step 7, we create our source for syslog messages, follow the image below for a reference. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-10.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-10.png?w=300&#34; alt=&#34;loganalyzer-8&#34;&gt;&lt;/a&gt; Looks like we are done the select the &amp;quot;here&amp;quot; link to go to the login page. &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-11.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-11.png?w=300&#34; alt=&#34;loganalyzer-9&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://systemstechblog.files.wordpress.com/2014/06/rsyslog-12.png&#34;&gt;&lt;img src=&#34;http://systemstechblog.files.wordpress.com/2014/06/rsyslog-12.png?w=300&#34; alt=&#34;loganalyzer-10&#34;&gt;&lt;/a&gt; Done! Some last things to check with LogAnalyzer is it does DNS lookups of IP address which can slow down the website if you have a lot of IPs in your logs. To disable that feature go to &lt;strong&gt;Admin Center -&amp;gt;Uncheck Resolve IP Addresses using DNS.&lt;/strong&gt; I have personally pushed up to 500 syslog messages every 10 seconds thanks to the Kiwi Syslog Generator and did not see any performance hits other than the DNS issue. Hope this information is helpful, let me know if you have used LogAnalyzer in a production environment, are there any gotchas? I have just been testing it on my lab and so far so good. &lt;strong&gt;Links:&lt;/strong&gt; &lt;a href=&#34;http://www.centos.org/&#34;&gt;CentOS&lt;/a&gt; &lt;a href=&#34;http://www.mysql.com/&#34;&gt;MySQL&lt;/a&gt; &lt;a href=&#34;http://www.rsyslog.com/&#34;&gt;RSYSLOG&lt;/a&gt; &lt;a href=&#34;http://loganalyzer.adiscon.com/&#34;&gt;LogAnalyzer&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&#34;comments&#34;&gt;Comments:&lt;/h3&gt;
&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;%22belalhossain53@gmail.com%22&#34;&gt;Md. Belal Hossain&lt;/a&gt; - &lt;time datetime=&#34;2015-07-07 06:04:22&#34;&gt;Jul 2, 2015&lt;/time&gt;&lt;/p&gt;
&lt;p&gt;Nice!!&lt;/p&gt;
&lt;hr /&gt;
#### 
[Ryan](http://ciscoskills.net/ &#34;lewiryan@isu.edu&#34;) - &lt;time datetime=&#34;2015-01-09 22:17:35&#34;&gt;Jan 5, 2015&lt;/time&gt;
&lt;p&gt;Glad it worked out.&lt;/p&gt;
&lt;hr /&gt;
#### 
[wim]( &#34;whmaas@hotmail.com&#34;) - &lt;time datetime=&#34;2015-01-09 03:30:33&#34;&gt;Jan 5, 2015&lt;/time&gt;
&lt;p&gt;thanks!!! tried several howto&#39;s for Centos with loganalizer....this is the only one works for me&lt;/p&gt;
&lt;hr /&gt;
#### 
[Ryan](http://ciscoskills.net/ &#34;lewiryan@isu.edu&#34;) - &lt;time datetime=&#34;2015-10-05 19:21:31&#34;&gt;Oct 1, 2015&lt;/time&gt;
&lt;p&gt;Hey Frank, Sorry for the late reply, in this install doc I&#39;m using Centos 6.5. I know things have changed between Centos 6.5 and 7 so what might work with Centos 6.5 may need some tweaking in Centos 7. I have personally not tested Loganalyzer on Centos 7, I would guess it works but that is only a guess. I would also use the latest stable software versions that are available for LogAnalyzer and RSYSLOG. This looks to be a permission issue with apache, I would verify apache has rights to write the config.php file. Hope that Helps, Ryan&lt;/p&gt;
&lt;hr /&gt;
#### 
[Jan Stasik]( &#34;janostasik@icloud.com&#34;) - &lt;time datetime=&#34;2015-10-21 08:22:47&#34;&gt;Oct 3, 2015&lt;/time&gt;
&lt;p&gt;HI Frank, I had same issue. I have followed the guide, of course, modified it to our needs. We have an issue on CentOS7 because of SElinux. Here is what i did: chown apache:apache -R /var/www/html/loganalyzer/ cd /var/www/html/loganalyzer/ find . -type f -exec chmod 0644 {} \; find . -type d -exec chmod 0755 {} \; chcon -t httpd_sys_content_t /var/www/html/loganalyzer -R chcon -t httpd_sys_rw_content_t /var/www/html/loganalyzer -R In my case I allowed to Apache write permission for full folder. Here is detailed description about each step. &lt;a href=&#34;http://blog.lysender.com/2015/07/centos-7-selinux-php-apache-cannot-writeaccess-file-no-matter-what/&#34;&gt;http://blog.lysender.com/2015/07/centos-7-selinux-php-apache-cannot-writeaccess-file-no-matter-what/&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
#### 
[Frank]( &#34;frankdaku@gmail.com&#34;) - &lt;time datetime=&#34;2015-09-30 09:46:59&#34;&gt;Sep 3, 2015&lt;/time&gt;
&lt;p&gt;Hi! First congrats to this manual, it is really nice. BUT I&#39;m facing a little problem (BUG???)on CentOS 7. Everything works, I use the same versions but after I execute the configure.sh, and open the loganalyzer gui, the second step fails with: &amp;quot;file &#39;./config.php&#39;&amp;quot; is not writable. I made chmod 666/777 apache restart, selinux disable, but nothing happens. It keep says, that the file is not writable. Actually the file is: -rw-rw-rw-. 1 root root 0 30. Sep 19:33 config.php Could you please help me to finish this install? Thank you in advance and best regards&lt;/p&gt;
&lt;hr /&gt;

        
      </description>
    </item>
    
  </channel>
</rss>
